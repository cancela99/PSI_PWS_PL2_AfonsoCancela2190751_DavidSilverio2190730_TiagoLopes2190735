<?php

use ArmoredCore\MagicBlankModel;
use ArmoredCore\WebObjects\Asset;
use ArmoredCore\WebObjects\Data;
use ArmoredCore\WebObjects\Session;
use ArmoredCore\WebObjects\URL;
use ArmoredCore\WebObjects\Layout;


//Verifica se o utilizador tem login feito
if(Session::has('userData')){
    Layout::includeLayout('headerLoggedIn');
}else{
    Layout::includeLayout('headerNotLoggedIn');
}

$user = Data::get('userError');
?>


    <body class="text-center">
    <div class="container" style="margin-top: 100px">
    <form class="form-signin" method="post" action="<?=Url::toRoute('user/login')?>">
        <img class="mb-4" src="<?= Asset::image('dices.png')?>" alt="" width=92" height="92">
        <h1 class="h3 mb-4 font-weight-normal">Shut the Box Game</h1>

            <label for="inputUsername" class=""</label>
            <input type="text" id="inputUsername"  class="form-control" placeholder="Nome de utilizador" required autofocus name="username" value="<?php if(!$user instanceof MagicBlankModel)echo $user?>">

            <label for="inputPassword" class=""></label>
            <input type="password" id="inputPassword" class="form-control" placeholder="Palavra-passe" required name="password">

<?php

if(Session::has('loginErrors')){?>
    <div style="background-color: #e66767; border: 1px solid #3c3836; width: 80%; padding: 3%;" class="container mt-5 rounded text-center">
        <h5 style="color: whitesmoke; font-size: 22px"><?php echo Session::get('loginErrors') ?> <i class="fa fa-exclamation-circle"></i></h5>
    </div>
    <?php
    Session::destroy();
}

if(Session::has('bloqueado')){?>
    <div style="background-color: #e66767; border: 1px solid #3c3836; width: 80%; padding: 3%;" class="container mt-5 rounded text-center">
        <h5 style="color: whitesmoke; font-size: 22px"><?php echo Session::get('bloqueado') ?> <i class="fa fa-exclamation-circle"></i></h5>
    </div>
    <?php
    Session::destroy();
}

if(Session::has('notLoggedIn')){?>
    <div style="background-color: #e66767; border: 1px solid #3c3836; width: 80%; padding: 3%;" class="container mt-5 rounded text-center">
        <h5 style="color: whitesmoke; font-size: 22px"><?php echo Session::get('notLoggedIn') ?> <i class="fa fa-exclamation-circle"></i></h5>
    </div>
    <?php
    Session::destroy();
}

if(Session::has('blankField')){?>
    <div style="background-color: #e66767; border: 1px solid #3c3836; width: 80%; padding: 3%;" class="container mt-5 rounded text-center">
        <h5 style="color: whitesmoke; font-size: 22px"><?php echo Session::get('blankField') ?> <i class="fa fa-exclamation-circle"></i></h5>
    </div>
    <?php
    Session::destroy();
}

if(Session::has('signInComplete')){?>
    <div style="background-color: #7ce075; border: 1px solid #3c3836; width: 80%; padding: 3%;" class="container mt-5 rounded text-center">
        <h5 style="color: whitesmoke; font-size: 22px"><?php echo Session::get('signInComplete') ?></h5>
    </div>
    <?php
    Session::destroy();
}
?>

        <button class="btn btn-lg btn-primary btn-block mt-4" type="submit">Iniciar Sessão</button>
        <div class="mb-3">
        </div>
    </form>
        <label>
            Não estás registado? Clica <a href="<?= URL::toRoute('stbox/register/')?>">AQUI</a> para te registares!
        </label>

    </div>
    </body>
<?php
Layout::includeLayout('footerproject');