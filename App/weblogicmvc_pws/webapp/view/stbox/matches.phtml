<?php

use ArmoredCore\WebObjects\Data;
use ArmoredCore\WebObjects\Layout;
use ArmoredCore\WebObjects\Session;
use ActiveRecord\DateTime;

//Verifica se o utilizador tem login feito
if(isset($_SESSION['loggedIn'])){
    Layout::includeLayout('headerLoggedIn');
}else{
    Layout::includeLayout('headerNotLoggedIn');
}

$matches = Data::get('matches');
//\Tracy\Debugger::barDump($matches);

?>


<h1 style="margin-top: 7%" class="text-center">Histórico de Partidas</h1>



<?php
if(isset($_SESSION['noMatches'])){
    echo '<br><p style="color:red; text-align: center; font-size: 18px">'.$_SESSION['noMatches'].'</p>';
}
?>

<div class="container mt-5">

    <table class="table table-hover">
        <thead>
        <tr>
            <th>#</th>
            <th>Pontuação</th>
            <th>Resultado</th>
            <th>Data</th>
        </tr>
        </thead>
        <tbody>

        <tr>
    <?php
        //Verifica se o utilizador tem alguma partida realizada, senão tiver nenhuma, avisa o utilizador
        $i = 1;
            if(!(isset($_SESSION['noMatches']))){
                //if(!is_null(Data::get('matches'))){?>
                <?php foreach ($matches as $match) {

                \Tracy\Debugger::barDump($match);

                $data = $match->data->format('d-m-Y');

                if ($match->idusername == Session::get('id')
                ){
                ?>
                    <th><?= $i ?></th>
                    <td><?= $match->pontuacao ?></td>
                    <?php
                    //Verificamos o campo vencedor de cada jogo e devolvemos o resultado do mesmo
                    switch ($match->vencedor) {
                        case 'G':
                            echo '<td>Ganhou</td>';
                            break;
                        case 'P':
                            echo '<td>Perdeu</td>';
                            break;
                        case 'E':
                            echo '<td>Empatou</td>';
                            break;
                    } ?>
                    <td><?= $data ?></td>
        </tr>
        <?php
            $i++;
                    }
                }
            }?>
        </tbody>
    </table>
</div>


<?php Layout::includeLayout('footerproject'); ?>