<?php

use ArmoredCore\WebObjects\Data;
use ArmoredCore\WebObjects\Layout;
use ArmoredCore\WebObjects\Session;

//Verifica se o utilizador tem login feito
if(/*isset($_SESSION['loggedIn'])*/Session::has('userData')){
    Layout::includeLayout('headerLoggedIn');
}else{
    Layout::includeLayout('headerNotLoggedIn');
}

$matches = Data::get('matches');

?>


<h1 style="margin-top: 7%" class="text-center">Histórico de Partidas</h1>



<?php
if(/*isset($_SESSION['noMatches'])*/Session::has('noMatches')){
    echo '<br><p style="color:red; text-align: center; font-size: 18px">'.Session::get('noMatches').'</p>';
}
?>

<div class="container mt-5">

    <table class="table table-hover">
        <thead>
        <tr>
            <th>#</th>
            <th>Pontuação</th>
            <th>Resultado</th>
            <th>Data</th>
        </tr>
        </thead>
        <tbody>

        <tr>
    <?php
    $i = Session::get('numRows');;
    //Verifica se o utilizador tem alguma partida realizada, senão tiver nenhuma, avisa o utilizador
    if(!(isset($_SESSION['noMatches']))){ ?>
        <?php foreach ($matches as $match) {
             ?>
                <th><?= $i ?></th>
                <td><?=$match->pontuacao?></td>
                <?php
                //Verificamos o campo vencedor de cada jogo e devolvemos o resultado do memso
                switch($match->vencedor){
                case 'G':
                    echo '<td>Ganhou</td>';
                    break;
                case 'P':
                    echo '<td>Perdeu</td>';
                    break;
                case 'E':
                    echo '<td>Empatou</td>';
                    break; } ?>
                <?php $data = date_create($match->data);
                //Formata a data?>
                <th style="font-weight: normal"><?=date_format($data,"d/m/Y")?></th>
            </tr>
            <?php $i--; }?>

    <?php }
    $_SESSION['noMatches'] = null;
    ?>
        </tbody>
    </table>
</div>


<?php Layout::includeLayout('footerproject'); ?>