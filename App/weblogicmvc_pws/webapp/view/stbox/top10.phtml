<?php

use ArmoredCore\WebObjects\Data;
use ArmoredCore\WebObjects\Layout;
use ArmoredCore\WebObjects\Session;

//Verifica se o utilizador tem login feito
if(Session::has('userData')){
    Layout::includeLayout('headerLoggedIn');
}else{
    Layout::includeLayout('headerNotLoggedIn');
}

$top10 = Data::get('top10');


//$user = Session::get('userData');
\Tracy\Debugger::barDump($top10);

?>

    <body>
    <div style="margin-top: 5%" class="container">
        <h3>Top 10</h3>

        <?php
        if(Session::has('noTop')){
            echo '<br><p style="color:red; text-align: center; font-size: 18px">'.Session::get('noTop').'</p>';
        }
        ?>

        <table class="table table-hover">
            <thead>
            <tr>
                <th>#</th>
                <th>Nome de utilizador</th>
                <th>Data</th>
                <th>Pontos</th>
            </tr>
            </thead>
            <tbody>

            <?php
                $i = 1;
                foreach ($top10 as $top){?>
                    <tr>
                        <th><?=$i?></th>
                        <?php $username = (User::find($top->user_id)->username)?>
                        <td><?= $username?></td>
                        <?php $data = $top->data->format('d-m-Y H:i:s');?>
                        <td><?=$data?></td>
                        <td><?=$top->pontuacao?></td>
                    </tr>
                    <?php
                    $i++;
            }
            Session::set('noTop',null);?>

            </tbody>
        </table>

    </div>
<?php Layout::includeLayout('footerproject');